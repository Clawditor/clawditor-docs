# ClawdPFPMarket.sol

### Audit Metadata
- **Requester**: @camdenInCrypto
- **Date**: January 28, 2026
- **Source Link**: [Twitter Request](https://x.com/camdenInCrypto/status/2016389595672252650)
- **Repo Link**: [clawdbotatg/clawd-pfp-market](https://github.com/clawdbotatg/clawd-pfp-market)

---

## ðŸ”¬ Analyzer Technical Report

| Impact | Title | Description |
| --- | --- | --- |
| Low | Dust Handling in Claims | The last claimer receives the entire remaining balance to clear dust, which is a good practice but could theoretically result in a slightly higher payout than intended for that specific user. |
| Info | Insertion Sort in `getTopSubmissions` | Uses insertion sort which is $O(n^2)$. While acceptable for a prediction market with a limited number of whitelisted submissions, it may hit gas limits if the submission count becomes very large. |

---

## ðŸ¦ž Clawditor AI Summary

### Architecture
The `ClawdPFPMarket` contract implements a Profile Picture (PFP) prediction market where users can submit image URLs and stake `$CLAWD` tokens. The system uses a bonding curve mechanism to reward early stakers on popular submissions. An admin picks the final winner after a deadline, triggering a distribution: 25% burn, 10% bonus to the original proposer (OP), and 65% shared among the stakers of the winning entry.

### Logic & Security Patterns
- **Bonding Curve Normalization**: The contract correctly normalizes total shares to whole units before price calculation (`currentTotalShares / 1e18`), preventing rapid price escalation caused by 18-decimal precision math.
- **Pull over Push**: Rewards are claimed by users via the `claim()` function rather than being pushed in a loop, mitigating unbounded gas consumption and potential DoS vectors.
- **State Integrity**: Proper use of `ReentrancyGuard` and `SafeERC20` ensures basic token and flow security.
- **Deadlock Mitigation**: Includes an `emergencyRescue` mechanism that allows stakers to recover funds if the admin fails to pick a winner within 30 days post-deadline.

### Findings
- **Admin Centralization**: The admin has significant power, including whitelisting entries, banning/slashing, and picking the final winner. The security of the market relies heavily on the `admin` address.
- **Symmetry check**: The `banAndSlash` function only allows banning `Pending` entries. Once whitelisted, an entry cannot be banned, which is a design decision that protects stakers but limits admin control over offensive content that might have slipped through.

### Verdict: SECURE ðŸ¦žâœ…
The contract is well-structured with clear consideration for common Solidity pitfalls. The bonding curve implementation is robust against decimal scaling errors, and the claim pattern is correctly implemented.

---
*Report generated by Clawditor AI*